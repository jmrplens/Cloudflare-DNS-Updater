<!DOCTYPE html>
<html xmlns='http://www.w3.org/1999/xhtml'>
  <head>
    <title>Code coverage for Dyndns cloudflare ipv4-6</title>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <script src='./assets/0.12.3/application.js' type='text/javascript'></script>
    <link href='./assets/0.12.3/application.css' media='screen, projection, print' rel='stylesheet' type='text/css' />
    <link rel="shortcut icon" type="image/png" href="./assets/0.12.3/favicon_red.png" />
    <link rel="icon" type="image/png" href="./assets/0.12.3/favicon.png" />
  </head>

  <body>
    <div id="loading">
      <img src="./assets/0.12.3/loading.gif" alt="loading"/>
    </div>
    <div id="wrapper" class="hide">
      <div class="timestamp">Generated <abbr class="timeago" title="2023-06-20T23:15:23+00:00">2023-06-20T23:15:23+00:00</abbr></div>
      <ul class="group_tabs"></ul>

      <div id="content">
        <div class="file_list_container" id="AllFiles">
  <h2>
    <span class="group_name">All Files</span>
    (<span class="covered_percent">
      <span class="red">
  62.28%
</span>

     </span>
     covered at
     <span class="covered_strength">
       <span class="green">
         2.96
       </span>
    </span> hits/line
    )
  </h2>

  <a name="AllFiles"></a>

  <div>
    <b>1</b> files in total.
  </div>

  <div class="t-line-summary">
    <b>281</b> relevant lines,
    <span class="green"><b>175</b> lines covered</span> and
    <span class="red"><b>106</b> lines missed. </span>
    (<span class="red">
  62.28%
</span>
)
  </div>

  

  <div class="file_list--responsive">
    <table class="file_list">
      <thead>
        <tr>
          <th>File</th>
          <th class="cell--number">% covered</th>
          <th class="cell--number">Lines</th>
          <th class="cell--number">Relevant Lines</th>
          <th class="cell--number">Lines covered</th>
          <th class="cell--number">Lines missed</th>
          <th class="cell--number">Avg. Hits / Line</th>
          
        </tr>
      </thead>
      <tbody>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#31b16162b74431f11b2fb48e0d0d74274944711a" class="src_link" title="update-cloudflare-records.sh">update-cloudflare-records.sh</a></td>
            <td class="red strong cell--number t-file__coverage">62.28 %</td>
            <td class="cell--number">497</td>
            <td class="cell--number">281</td>
            <td class="cell--number">175</td>
            <td class="cell--number">106</td>
            <td class="cell--number">2.96</td>
            
          </tr>
        
      </tbody>
    </table>
  </div>
</div>


        
      </div>

      <div id="footer">
        Generated by <a href="https://github.com/simplecov-ruby/simplecov">simplecov</a> v0.21.2
        and simplecov-html v0.12.3<br/>
        using /bin/bash unit-test.sh
      </div>

      <div class="source_files">
      
        <div class="source_table" id="31b16162b74431f11b2fb48e0d0d74274944711a">
  <div class="header">
    <h3>update-cloudflare-records.sh</h3>
    <h4>
      <span class="red">
  62.28%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>281</b> relevant lines.
      <span class="green"><b>175</b> lines covered</span> and
      <span class="red"><b>106</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1">
            
            

            

            <code class="ruby">#!/usr/bin/env bash</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="2">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="3">
            
            

            

            <code class="ruby"># Default settings</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="5" data-linenumber="4">
            <span class="hits">5</span>
            

            

            <code class="ruby">def_ip_type=&quot;external&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="5" data-linenumber="5">
            <span class="hits">5</span>
            

            

            <code class="ruby">def_ip_type_enabled=false</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="5" data-linenumber="6">
            <span class="hits">5</span>
            

            

            <code class="ruby">def_ttl=&quot;auto&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="5" data-linenumber="7">
            <span class="hits">5</span>
            

            

            <code class="ruby">def_ttl_enabled=false</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="5" data-linenumber="8">
            <span class="hits">5</span>
            

            

            <code class="ruby">def_proxied=true</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="5" data-linenumber="9">
            <span class="hits">5</span>
            

            

            <code class="ruby">def_proxied_enabled=false</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="5" data-linenumber="10">
            <span class="hits">5</span>
            

            

            <code class="ruby">def_ipv4=true</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="5" data-linenumber="11">
            <span class="hits">5</span>
            

            

            <code class="ruby">def_ipv4_enabled=false</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="5" data-linenumber="12">
            <span class="hits">5</span>
            

            

            <code class="ruby">def_ipv6=false</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="5" data-linenumber="13">
            <span class="hits">5</span>
            

            

            <code class="ruby">def_ipv6_enabled=false</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="14">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="15">
            
            

            

            <code class="ruby"># Globals</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="5" data-linenumber="16">
            <span class="hits">5</span>
            

            

            <code class="ruby">error_dom=false</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="5" data-linenumber="17">
            <span class="hits">5</span>
            

            

            <code class="ruby">ip4=&quot;&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="5" data-linenumber="18">
            <span class="hits">5</span>
            

            

            <code class="ruby">ip6=&quot;&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="5" data-linenumber="19">
            <span class="hits">5</span>
            

            

            <code class="ruby">dns_record_ip4=&quot;&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="5" data-linenumber="20">
            <span class="hits">5</span>
            

            

            <code class="ruby">dns_record_id_4=&quot;&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="5" data-linenumber="21">
            <span class="hits">5</span>
            

            

            <code class="ruby">dns_record_ip6=&quot;&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="5" data-linenumber="22">
            <span class="hits">5</span>
            

            

            <code class="ruby">dns_record_id_6=&quot;&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="5" data-linenumber="23">
            <span class="hits">5</span>
            

            

            <code class="ruby">is_proxied4=&quot;&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="5" data-linenumber="24">
            <span class="hits">5</span>
            

            

            <code class="ruby">is_proxied6=&quot;&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="5" data-linenumber="25">
            <span class="hits">5</span>
            

            

            <code class="ruby">is_proxiable4=&quot;&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="5" data-linenumber="26">
            <span class="hits">5</span>
            

            

            <code class="ruby">is_proxiable6=&quot;&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="27">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="28">
            
            

            

            <code class="ruby"># Colors</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="10" data-linenumber="29">
            <span class="hits">10</span>
            

            

            <code class="ruby">end_color=$(tput sgr0)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="10" data-linenumber="30">
            <span class="hits">10</span>
            

            

            <code class="ruby">done_fb=$(tput setab 2 &amp;&amp; tput setaf 0 &amp;&amp; tput bold)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="10" data-linenumber="31">
            <span class="hits">10</span>
            

            

            <code class="ruby">done_c=$(tput setaf 2 &amp;&amp; tput bold)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="10" data-linenumber="32">
            <span class="hits">10</span>
            

            

            <code class="ruby">err_c=$(tput setaf 1)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="10" data-linenumber="33">
            <span class="hits">10</span>
            

            

            <code class="ruby">load_c=$(tput setaf 3 &amp;&amp; tput bold)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="10" data-linenumber="34">
            <span class="hits">10</span>
            

            

            <code class="ruby">warn_c=$(tput setaf 3)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="10" data-linenumber="35">
            <span class="hits">10</span>
            

            

            <code class="ruby">blue_b_c=$(tput setaf 4 &amp;&amp; tput bold)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="10" data-linenumber="36">
            <span class="hits">10</span>
            

            

            <code class="ruby">green_c=$(tput setaf 2)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="37">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="38">
            
            

            

            <code class="ruby"># Server to check external IP</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="5" data-linenumber="39">
            <span class="hits">5</span>
            

            

            <code class="ruby">get_ip_from=&quot;https://icanhazip.com&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="40">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="41">
            
            

            

            <code class="ruby">##################################################################</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="42">
            
            

            

            <code class="ruby"># GENERIC FUNCTIONS</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="43">
            
            

            

            <code class="ruby">done_fb_msg() {</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="44">
            
            

            

            <code class="ruby">  echo &quot;${done_fb}${1}${end_color}&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="45">
            
            

            

            <code class="ruby">}</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="46">
            
            

            

            <code class="ruby">done_msg() {</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="47">
            
            

            

            <code class="ruby">  echo &quot;${done_c}${1}${end_color}&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="48">
            
            

            

            <code class="ruby">}</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="49">
            
            

            

            <code class="ruby">error_msg() {</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="9" data-linenumber="50">
            <span class="hits">9</span>
            

            

            <code class="ruby">  echo &quot;${err_c}${1}${end_color}&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="51">
            
            

            

            <code class="ruby">}</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="52">
            
            

            

            <code class="ruby">warn_msg() {</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="53">
            
            

            

            <code class="ruby">  echo &quot;${warn_c}${1}${end_color}&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="54">
            
            

            

            <code class="ruby">}</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="55">
            
            

            

            <code class="ruby">load_msg() {</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="56">
            
            

            

            <code class="ruby">  echo &quot;${load_c}${1}${end_color}&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="57">
            
            

            

            <code class="ruby">}</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="58">
            
            

            

            <code class="ruby">blue_bold_msg() {</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="3" data-linenumber="59">
            <span class="hits">3</span>
            

            

            <code class="ruby">  echo &quot;${blue_b_c}${1}${end_color}&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="60">
            
            

            

            <code class="ruby">}</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="61">
            
            

            

            <code class="ruby">green_msg() {</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="62">
            
            

            

            <code class="ruby">  echo &quot;${green_c}${1}${end_color}&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="63">
            
            

            

            <code class="ruby">}</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="64">
            
            

            

            <code class="ruby"># shellcheck disable=SC2154</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="65">
            
            

            

            <code class="ruby">get_domain_settings() {</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="3" data-linenumber="66">
            <span class="hits">3</span>
            

            

            <code class="ruby">  domain_name=${domains__name[$i]}</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="3" data-linenumber="67">
            <span class="hits">3</span>
            

            

            <code class="ruby">  if [ $def_ip_type_enabled == false ]; then</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="3" data-linenumber="68">
            <span class="hits">3</span>
            

            

            <code class="ruby">    domain_ip_type=${domains__ip_type[$i]}</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="69">
            
            

            

            <code class="ruby">  else</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="70">
            
            

            

            <code class="ruby">    domain_ip_type=${def_ip_type}</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="71">
            
            

            

            <code class="ruby">  fi</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="3" data-linenumber="72">
            <span class="hits">3</span>
            

            

            <code class="ruby">  if [ $def_ipv4_enabled == false ]; then</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="3" data-linenumber="73">
            <span class="hits">3</span>
            

            

            <code class="ruby">    enable_ipv4=${domains__ipv4[$i]}</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="74">
            
            

            

            <code class="ruby">  else</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="75">
            
            

            

            <code class="ruby">    enable_ipv4=${def_ipv4}</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="76">
            
            

            

            <code class="ruby">  fi</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="3" data-linenumber="77">
            <span class="hits">3</span>
            

            

            <code class="ruby">  if [ $def_ipv6_enabled == false ]; then</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="3" data-linenumber="78">
            <span class="hits">3</span>
            

            

            <code class="ruby">    enable_ipv6=${domains__ipv6[$i]}</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="79">
            
            

            

            <code class="ruby">  else</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="80">
            
            

            

            <code class="ruby">    enable_ipv6=${def_ipv6}</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="81">
            
            

            

            <code class="ruby">  fi</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="3" data-linenumber="82">
            <span class="hits">3</span>
            

            

            <code class="ruby">  if [ $def_proxied_enabled == false ]; then</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="3" data-linenumber="83">
            <span class="hits">3</span>
            

            

            <code class="ruby">    domain_proxied=${domains__proxied[$i]}</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="84">
            
            

            

            <code class="ruby">  else</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="85">
            
            

            

            <code class="ruby">    domain_proxied=${def_proxied}</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="86">
            
            

            

            <code class="ruby">  fi</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="3" data-linenumber="87">
            <span class="hits">3</span>
            

            

            <code class="ruby">  if [ $def_ttl_enabled == false ]; then</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="3" data-linenumber="88">
            <span class="hits">3</span>
            

            

            <code class="ruby">    domain_ttl=${domains__ttl[$i]}</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="89">
            
            

            

            <code class="ruby">  else</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="90">
            
            

            

            <code class="ruby">    domain_ttl=${def_ttl}</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="91">
            
            

            

            <code class="ruby">  fi</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="3" data-linenumber="92">
            <span class="hits">3</span>
            

            

            <code class="ruby">  echo &quot;$domain_name $domain_ip_type $enable_ipv4 $enable_ipv6 $domain_proxied $domain_ttl&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="93">
            
            

            

            <code class="ruby">}</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="94">
            
            

            

            <code class="ruby"># shellcheck disable=SC2154</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="95">
            
            

            

            <code class="ruby">get_api_settings() {</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="96">
            <span class="hits">1</span>
            

            

            <code class="ruby">  api_zone_id=$settings_cloudflare__zone_id</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="97">
            <span class="hits">1</span>
            

            

            <code class="ruby">  api_zone_token=$settings_cloudflare__zone_api_token</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="98">
            <span class="hits">1</span>
            

            

            <code class="ruby">  echo &quot;$api_zone_id $api_zone_token&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="99">
            
            

            

            <code class="ruby">}</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="100">
            
            

            

            <code class="ruby">##################################################################</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="101">
            
            

            

            <code class="ruby"># CLOUDFLARE API FUNCTIONS</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="102">
            
            

            

            <code class="ruby">api_validation() {</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="24" data-linenumber="103">
            <span class="hits">24</span>
            

            

            <code class="ruby">  success_api=$(echo &quot;${1}&quot; | grep -o &#39;&quot;success&quot;:[^,]*&#39; | grep -o &#39;[^:]*$&#39;)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="6" data-linenumber="104">
            <span class="hits">6</span>
            

            

            <code class="ruby">  if [ &quot;$success_api&quot; == false ]; then</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="6" data-linenumber="105">
            <span class="hits">6</span>
            

            

            <code class="ruby">    error_msg &quot;Error! Can&#39;t get ${end_color}${load_c}$2${end_color}${done_c} $3 record information from Cloudflare API&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="6" data-linenumber="106">
            <span class="hits">6</span>
            

            

            <code class="ruby">    error_dom=true</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="107">
            
            

            

            <code class="ruby">  else</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="108">
            
            

            

            <code class="ruby">    done_msg &quot;Loaded ${end_color}${load_c}$2${end_color}${done_c} $3 record information from Cloudflare API&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="109">
            
            

            

            <code class="ruby">    error_dom=false</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="110">
            
            

            

            <code class="ruby">  fi</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="111">
            
            

            

            <code class="ruby">}</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="112">
            
            

            

            <code class="ruby">push_validation() {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="113">
            
            

            

            <code class="ruby">  success_api=$(echo &quot;${1}&quot; | grep -o &#39;&quot;success&quot;:[^,]*&#39; | grep -o &#39;[^:]*$&#39;)</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="114">
            
            

            

            <code class="ruby">  if [ &quot;$success_api&quot; == false ]; then</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="115">
            
            

            

            <code class="ruby">    error_msg &quot;Error! Update $2 Failed&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="116">
            
            

            

            <code class="ruby">    error_dom=true</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="117">
            
            

            

            <code class="ruby">  else</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="118">
            
            

            

            <code class="ruby">    done_msg &quot;Pushed new $2&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="119">
            
            

            

            <code class="ruby">    error_dom=false</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="120">
            
            

            

            <code class="ruby">  fi</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="121">
            
            

            

            <code class="ruby">}</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="122">
            
            

            

            <code class="ruby">external_validation() {</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="6" data-linenumber="123">
            <span class="hits">6</span>
            

            

            <code class="ruby">  if [ -z &quot;$1&quot; ]; then</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="3" data-linenumber="124">
            <span class="hits">3</span>
            

            

            <code class="ruby">    error_msg &quot;Error! Can&#39;t get external $2 from $get_ip_from&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="3" data-linenumber="125">
            <span class="hits">3</span>
            

            

            <code class="ruby">    exit 0</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="126">
            
            

            

            <code class="ruby">  else</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="3" data-linenumber="127">
            <span class="hits">3</span>
            

            

            <code class="ruby">    blue_bold_msg &quot;Current External $2 is: $1&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="3" data-linenumber="128">
            <span class="hits">3</span>
            

            

            <code class="ruby">    return 1</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="129">
            
            

            

            <code class="ruby">  fi</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="130">
            
            

            

            <code class="ruby">}</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="131">
            
            

            

            <code class="ruby">internal_validation() {</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="132">
            
            

            

            <code class="ruby">  if [ -z &quot;$1&quot; ]; then</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="133">
            
            

            

            <code class="ruby">    error_msg &quot;Error! Can&#39;t read $2 from $3&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="134">
            
            

            

            <code class="ruby">    exit 0</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="135">
            
            

            

            <code class="ruby">  else</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="136">
            
            

            

            <code class="ruby">    done_msg &quot;Internal $3 $2 is: $1&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="137">
            
            

            

            <code class="ruby">    return 1</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="138">
            
            

            

            <code class="ruby">  fi</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="139">
            
            

            

            <code class="ruby">}</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="140">
            
            

            

            <code class="ruby">read_record() {</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="6" data-linenumber="141">
            <span class="hits">6</span>
            

            

            <code class="ruby">  curl -s -X GET &quot;https://api.cloudflare.com/client/v4/zones/$1/dns_records?type=$3&amp;name=$4&quot; \</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="142">
            
            

            

            <code class="ruby">    -H &quot;Authorization: Bearer $2&quot; \</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="143">
            
            

            

            <code class="ruby">    -H &quot;Content-Type: application/json&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="144">
            
            

            

            <code class="ruby">}</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="145">
            
            

            

            <code class="ruby">write_record() {</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="146">
            
            

            

            <code class="ruby">  curl -s -X PUT &quot;https://api.cloudflare.com/client/v4/zones/$1/dns_records/$2&quot; \</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="147">
            
            

            

            <code class="ruby">    -H &quot;Authorization: Bearer $3&quot; \</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="148">
            
            

            

            <code class="ruby">    -H &quot;Content-Type: application/json&quot; \</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="149">
            
            

            

            <code class="ruby">    --data &quot;{\&quot;type\&quot;:\&quot;$4\&quot;,\&quot;name\&quot;:\&quot;$5\&quot;,\&quot;content\&quot;:\&quot;$6\&quot;,\&quot;ttl\&quot;:$7,\&quot;proxied\&quot;:$8}&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="150">
            
            

            

            <code class="ruby">}</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="151">
            
            

            

            <code class="ruby">up_to_date () {</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="152">
            
            

            

            <code class="ruby">  done_msg &quot;Current DNS record ${1} of ${end_color}${load_c}${2}${end_color}${done_c} is ${3} and proxy status is ${4}, no changes needed.&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="153">
            
            

            

            <code class="ruby">}</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="154">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="155">
            
            

            

            <code class="ruby">##################################################################</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="156">
            
            

            

            <code class="ruby"># NETWORK FUNCTIONS</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="157">
            
            

            

            <code class="ruby">get_ip_external() {</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="3" data-linenumber="158">
            <span class="hits">3</span>
            

            

            <code class="ruby">  if [ &quot;$1&quot; == true ]; then</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="6" data-linenumber="159">
            <span class="hits">6</span>
            

            

            <code class="ruby">    ip4=$(curl -4 -s -X GET $get_ip_from --max-time 20)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="160">
            
            

            

            <code class="ruby">  else</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="161">
            
            

            

            <code class="ruby">    ip4=&quot;&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="162">
            
            

            

            <code class="ruby">  fi</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="3" data-linenumber="163">
            <span class="hits">3</span>
            

            

            <code class="ruby">  if [ &quot;$2&quot; == true ]; then</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="6" data-linenumber="164">
            <span class="hits">6</span>
            

            

            <code class="ruby">    ip6=$(curl -6 -s -X GET $get_ip_from --max-time 20)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="165">
            
            

            

            <code class="ruby">  else</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="166">
            
            

            

            <code class="ruby">    ip6=&quot;&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="167">
            
            

            

            <code class="ruby">  fi</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="3" data-linenumber="168">
            <span class="hits">3</span>
            

            

            <code class="ruby">  echo &quot;$ip4&quot; &quot;$ip6&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="169">
            
            

            

            <code class="ruby">}</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="170">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="171">
            
            

            

            <code class="ruby">get_ip_internal() {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="172">
            
            

            

            <code class="ruby">  ### Check if &quot;IP&quot; command is present, get the ip from interface</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="173">
            
            

            

            <code class="ruby">  if which ip &gt;/dev/null; then</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="174">
            
            

            

            <code class="ruby">    ### &quot;ip route get&quot; (linux)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="175">
            
            

            

            <code class="ruby">    interface=$(ip route get 1.1.1.1 | awk &#39;/dev/ { print $5 }&#39;)</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="176">
            
            

            

            <code class="ruby">    if [ &quot;${1}&quot; == true ]; then</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="177">
            
            

            

            <code class="ruby">      ip4=$(ip -o -4 addr show &quot;${interface}&quot; scope global | awk &#39;{print $4;}&#39; | cut -d/ -f 1)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="178">
            
            

            

            <code class="ruby">    else</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="179">
            
            

            

            <code class="ruby">      ip4=&quot;&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="180">
            
            

            

            <code class="ruby">    fi</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="181">
            
            

            

            <code class="ruby">    if [ &quot;${2}&quot; == true ]; then</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="182">
            
            

            

            <code class="ruby">      ip6=$(ip -o -6 addr show &quot;${interface}&quot; scope global | awk &#39;{print $4;}&#39; | cut -d/ -f 1)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="183">
            
            

            

            <code class="ruby">    else</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="184">
            
            

            

            <code class="ruby">      ip6=&quot;&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="185">
            
            

            

            <code class="ruby">    fi</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="186">
            
            

            

            <code class="ruby">  ### if no &quot;IP&quot; command use &quot;ifconfig&quot;, get the ip from interface</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="187">
            
            

            

            <code class="ruby">  else</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="188">
            
            

            

            <code class="ruby">    ### &quot;route get&quot; (macOS, Freebsd)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="189">
            
            

            

            <code class="ruby">    interface=$(route get 1.1.1.1 | awk &#39;/interface:/ { print $2 }&#39;)</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="190">
            
            

            

            <code class="ruby">    if [ &quot;${1}&quot; == true ]; then</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="191">
            
            

            

            <code class="ruby">      ip4=$(ifconfig &quot;${interface}&quot; | grep &#39;inet &#39; | awk &#39;{print $2}&#39;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="192">
            
            

            

            <code class="ruby">    else</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="193">
            
            

            

            <code class="ruby">      ip4=&quot;&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="194">
            
            

            

            <code class="ruby">    fi</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="195">
            
            

            

            <code class="ruby">    if [ &quot;${2}&quot; == true ]; then</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="196">
            
            

            

            <code class="ruby">      ip6=$(ifconfig &quot;${interface}&quot; | grep &#39;inet6 &#39; | awk -F &#39;[ \t]+|/&#39; &#39;{print $3}&#39; | grep -v ^::1 | grep -v ^fe80)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="197">
            
            

            

            <code class="ruby">    else</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="198">
            
            

            

            <code class="ruby">      ip6=&quot;&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="199">
            
            

            

            <code class="ruby">    fi</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="200">
            
            

            

            <code class="ruby">  fi</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="201">
            
            

            

            <code class="ruby">  echo &quot;$ip4&quot; &quot;$ip6&quot; &quot;$interface&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="202">
            
            

            

            <code class="ruby">}</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="203">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="204">
            
            

            

            <code class="ruby">get_ip() {</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="3" data-linenumber="205">
            <span class="hits">3</span>
            

            

            <code class="ruby">  local ip_type=$1</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="3" data-linenumber="206">
            <span class="hits">3</span>
            

            

            <code class="ruby">  local enable_ipv4=$2</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="3" data-linenumber="207">
            <span class="hits">3</span>
            

            

            <code class="ruby">  local enable_ipv6=$3</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="208">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="209">
            
            

            

            <code class="ruby">  # Get External ip from &#39;$get_ip_from&#39;</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="3" data-linenumber="210">
            <span class="hits">3</span>
            

            

            <code class="ruby">  if [ &quot;$ip_type&quot; == &quot;external&quot; ]; then</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="6" data-linenumber="211">
            <span class="hits">6</span>
            

            

            <code class="ruby">    read -r ip4 ip6 &lt;&lt;&lt; &quot;$(get_ip_external &quot;$enable_ipv4&quot; &quot;$enable_ipv6&quot;)&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="6" data-linenumber="212">
            <span class="hits">6</span>
            

            

            <code class="ruby">    [[ &quot;$enable_ipv4&quot; == true ]] &amp;&amp; (external_validation &quot;$ip4&quot; &quot;IPv4&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="6" data-linenumber="213">
            <span class="hits">6</span>
            

            

            <code class="ruby">    [[ &quot;$enable_ipv6&quot; == true ]] &amp;&amp; (external_validation &quot;$ip6&quot; &quot;IPv6&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="3" data-linenumber="214">
            <span class="hits">3</span>
            

            

            <code class="ruby">    printf &quot;\n&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="215">
            
            

            

            <code class="ruby">  fi</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="216">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="217">
            
            

            

            <code class="ruby">  ### Get Internal IP from primary interface</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="3" data-linenumber="218">
            <span class="hits">3</span>
            

            

            <code class="ruby">  if [ &quot;$ip_type&quot; == &quot;internal&quot; ]; then</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="219">
            
            

            

            <code class="ruby">    read -r ip4 ip6 interface &lt;&lt;&lt; &quot;$(get_ip_internal &quot;$2&quot; &quot;$3&quot;)&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="220">
            
            

            

            <code class="ruby">    [[ &quot;$enable_ipv4&quot; == true ]] &amp;&amp; (internal_validation &quot;$ip4&quot; &quot;IPv4&quot; &quot;$interface&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="221">
            
            

            

            <code class="ruby">    [[ &quot;$enable_ipv6&quot; == true ]] &amp;&amp; (internal_validation &quot;$ip6&quot; &quot;IPv6&quot; &quot;$interface&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="222">
            
            

            

            <code class="ruby">    printf &quot;\n&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="223">
            
            

            

            <code class="ruby">  fi</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="224">
            
            

            

            <code class="ruby">}</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="225">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="226">
            
            

            

            <code class="ruby">get_dns_record_ip() {</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="3" data-linenumber="227">
            <span class="hits">3</span>
            

            

            <code class="ruby">  local domain_name=$1</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="3" data-linenumber="228">
            <span class="hits">3</span>
            

            

            <code class="ruby">  local zone_id=$2</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="3" data-linenumber="229">
            <span class="hits">3</span>
            

            

            <code class="ruby">  local zone_token=$3</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="230">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="231">
            
            

            

            <code class="ruby">  ### Get the dns record id and current proxy status from cloudflare&#39;s api</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="3" data-linenumber="232">
            <span class="hits">3</span>
            

            

            <code class="ruby">  if [ &quot;${enable_ipv4}&quot; == true ]; then</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="6" data-linenumber="233">
            <span class="hits">6</span>
            

            

            <code class="ruby">    dns_record_info4=$(read_record &quot;$zone_id&quot; &quot;$zone_token&quot; &quot;A&quot; &quot;$domain_name&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="3" data-linenumber="234">
            <span class="hits">3</span>
            

            

            <code class="ruby">    api_validation &quot;$dns_record_info4&quot; &quot;$domain_name&quot; &quot;IPv4&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="12" data-linenumber="235">
            <span class="hits">12</span>
            

            

            <code class="ruby">    is_proxied4=$(echo &quot;${dns_record_info4}&quot; | grep -o &#39;&quot;proxied&quot;:[^,]*&#39; | grep -o &#39;[^:]*$&#39;)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="12" data-linenumber="236">
            <span class="hits">12</span>
            

            

            <code class="ruby">    is_proxiable4=$(echo &quot;${dns_record_info4}&quot; | grep -o &#39;&quot;proxiable&quot;:[^,]*&#39; | grep -o &#39;[^:]*$&#39;)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="12" data-linenumber="237">
            <span class="hits">12</span>
            

            

            <code class="ruby">    dns_record_ip4=$(echo &quot;${dns_record_info4}&quot; | grep -o &#39;&quot;content&quot;:&quot;[^&quot;]*&#39; | cut -d&#39;&quot;&#39; -f 4)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="12" data-linenumber="238">
            <span class="hits">12</span>
            

            

            <code class="ruby">    dns_record_id_4=$(echo &quot;${dns_record_info4}&quot; | grep -o &#39;&quot;id&quot;:&quot;[^&quot;]*&#39; | cut -d&#39;&quot;&#39; -f4)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="3" data-linenumber="239">
            <span class="hits">3</span>
            

            

            <code class="ruby">    [[ &quot;$is_proxiable4&quot; == false ]] &amp;&amp; domain_proxied=false</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="240">
            
            

            

            <code class="ruby">  fi</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="3" data-linenumber="241">
            <span class="hits">3</span>
            

            

            <code class="ruby">  if [ &quot;${enable_ipv6}&quot; == true ]; then</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="6" data-linenumber="242">
            <span class="hits">6</span>
            

            

            <code class="ruby">    dns_record_info6=$(read_record &quot;$zone_id&quot; &quot;$zone_token&quot; &quot;AAAA&quot; &quot;$domain_name&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="3" data-linenumber="243">
            <span class="hits">3</span>
            

            

            <code class="ruby">    api_validation &quot;$dns_record_info6&quot; &quot;$domain_name&quot; &quot;IPv6&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="12" data-linenumber="244">
            <span class="hits">12</span>
            

            

            <code class="ruby">    is_proxied6=$(echo &quot;${dns_record_info6}&quot; | grep -o &#39;&quot;proxied&quot;:[^,]*&#39; | grep -o &#39;[^:]*$&#39;)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="12" data-linenumber="245">
            <span class="hits">12</span>
            

            

            <code class="ruby">    is_proxiable6=$(echo &quot;${dns_record_info6}&quot; | grep -o &#39;&quot;proxiable&quot;:[^,]*&#39; | grep -o &#39;[^:]*$&#39;)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="12" data-linenumber="246">
            <span class="hits">12</span>
            

            

            <code class="ruby">    dns_record_ip6=$(echo &quot;${dns_record_info6}&quot; | grep -o &#39;&quot;content&quot;:&quot;[^&quot;]*&#39; | cut -d&#39;&quot;&#39; -f 4)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="12" data-linenumber="247">
            <span class="hits">12</span>
            

            

            <code class="ruby">    dns_record_id_6=$(echo &quot;${dns_record_info6}&quot; | grep -o &#39;&quot;id&quot;:&quot;[^&quot;]*&#39; | cut -d&#39;&quot;&#39; -f4)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="3" data-linenumber="248">
            <span class="hits">3</span>
            

            

            <code class="ruby">    [[ &quot;$is_proxiable6&quot; == false ]] &amp;&amp; domain_proxied=false</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="249">
            
            

            

            <code class="ruby">  fi</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="250">
            
            

            

            <code class="ruby">}</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="251">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="252">
            
            

            

            <code class="ruby">##################################################################</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="253">
            
            

            

            <code class="ruby"># Input settings validation</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="254">
            
            

            

            <code class="ruby">settings_validation() {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="255">
            
            

            

            <code class="ruby">  # Check if &quot;cloudflare_zone_id&quot; is set</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="256">
            <span class="hits">1</span>
            

            

            <code class="ruby">  if [ -z &quot;$settings_cloudflare__zone_id&quot; ]; then</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="257">
            
            

            

            <code class="ruby">    error_msg &quot;Error! Cloudflare Zone ID not set&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="258">
            
            

            

            <code class="ruby">    exit 0</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="259">
            
            

            

            <code class="ruby">  fi</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="260">
            
            

            

            <code class="ruby">  # Check if &quot;cloudflare_zone_api_token&quot; is set</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="261">
            <span class="hits">1</span>
            

            

            <code class="ruby">  if [ -z &quot;$settings_cloudflare__zone_api_token&quot; ]; then</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="262">
            
            

            

            <code class="ruby">    error_msg &quot;Error! Cloudflare API Token not set&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="263">
            
            

            

            <code class="ruby">    exit 0</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="264">
            
            

            

            <code class="ruby">  fi</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="265">
            
            

            

            <code class="ruby">}</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="266">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="267">
            
            

            

            <code class="ruby">settings_domains_validation() {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="268">
            
            

            

            <code class="ruby">  # Domains quantity</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="269">
            <span class="hits">1</span>
            

            

            <code class="ruby">  n_doms=${#domains__name[@]}</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="270">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="8" data-linenumber="271">
            <span class="hits">8</span>
            

            

            <code class="ruby">  for ((i = 0; i &lt; n_doms; i++)); do</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="272">
            
            

            

            <code class="ruby">    # Check if &quot;name&quot; parameter is set</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="3" data-linenumber="273">
            <span class="hits">3</span>
            

            

            <code class="ruby">    if [ -z &quot;${domains__name[$i]}&quot; ]; then</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="274">
            
            

            

            <code class="ruby">      error_msg &quot;Error! Domain name not set&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="275">
            
            

            

            <code class="ruby">      exit 0</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="276">
            
            

            

            <code class="ruby">    fi</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="277">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="278">
            
            

            

            <code class="ruby">    # Check validity of &quot;ttl&quot; parameter</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="3" data-linenumber="279">
            <span class="hits">3</span>
            

            

            <code class="ruby">    if [ &quot;${domains__ttl[$i]}&quot; -lt 120 ] 2&gt;/dev/null ||</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="3" data-linenumber="280">
            <span class="hits">3</span>
            

            

            <code class="ruby">      [ &quot;${domains__ttl[$i]}&quot; -gt 7200 ] 2&gt;/dev/null ||</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="3" data-linenumber="281">
            <span class="hits">3</span>
            

            

            <code class="ruby">      [ &quot;${domains__ttl[$i]}&quot; != &quot;auto&quot; ]; then</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="282">
            
            

            

            <code class="ruby">      warn_msg &quot;Error! &#39;ttl&#39; out of range (120-7200) or not set to &#39;auto&#39;. Force set to &#39;$def_ttl&#39;&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="283">
            
            

            

            <code class="ruby">      def_ttl_enabled=true</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="284">
            
            

            

            <code class="ruby">    fi</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="285">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="286">
            
            

            

            <code class="ruby">    # Check validity of &quot;proxied&quot; parameter</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="3" data-linenumber="287">
            <span class="hits">3</span>
            

            

            <code class="ruby">    if [ &quot;${domains__proxied[$i]}&quot; != &quot;false&quot; ] &amp;&amp;</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="288">
            <span class="hits">2</span>
            

            

            <code class="ruby">      [ &quot;${domains__proxied[$i]}&quot; != &quot;true&quot; ]; then</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="289">
            
            

            

            <code class="ruby">      warn_msg &quot;Error! Incorrect &#39;proxied&#39; parameter, choose &#39;true&#39; or &#39;false&#39;. Force set to &#39;$def_proxied&#39;&#39;&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="290">
            
            

            

            <code class="ruby">      def_proxied_enabled=true</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="291">
            
            

            

            <code class="ruby">    fi</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="292">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="293">
            
            

            

            <code class="ruby">    # Check validity of &quot;what_ip&quot; parameter</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="3" data-linenumber="294">
            <span class="hits">3</span>
            

            

            <code class="ruby">    if [ &quot;${domains__ip_type[$i]}&quot; != &quot;external&quot; ] &amp;&amp;</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="295">
            
            

            

            <code class="ruby">      [ &quot;${domains__ip_type[$i]}&quot; != &quot;internal&quot; ]; then</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="296">
            
            

            

            <code class="ruby">      warn_msg &quot;Error! Incorrect &#39;ip_type&#39; parameter choose &#39;external&#39; or &#39;internal&#39;. Force set to &#39;$def_ip_type&#39;&#39;&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="297">
            
            

            

            <code class="ruby">      def_ip_type_enabled=true</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="298">
            
            

            

            <code class="ruby">    fi</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="299">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="300">
            
            

            

            <code class="ruby">    # Check if set to internal ip and proxy</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="3" data-linenumber="301">
            <span class="hits">3</span>
            

            

            <code class="ruby">    if [ &quot;${domains__ip_type[$i]}&quot; == &quot;internal&quot; ] &amp;&amp;</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="302">
            
            

            

            <code class="ruby">      [ &quot;${domains__proxied[$i]}&quot; == &quot;true&quot; ]; then</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="303">
            
            

            

            <code class="ruby">      error_msg &quot;Error! Internal IP cannot be Proxied&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="304">
            
            

            

            <code class="ruby">      exit 0</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="305">
            
            

            

            <code class="ruby">    fi</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="306">
            
            

            

            <code class="ruby">  done</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="307">
            
            

            

            <code class="ruby">}</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="308">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="309">
            
            

            

            <code class="ruby">settings_file_validation() {</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="310">
            <span class="hits">1</span>
            

            

            <code class="ruby">  if [[ -z &quot;$1&quot; ]]; then # If not set explicit config file and no exist default config</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="311">
            
            

            

            <code class="ruby">    if [ ! -f &quot;${parent_path}&quot;/update-cloudflare-records.yaml ]; then</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="312">
            
            

            

            <code class="ruby">      error_msg &quot;Error! Missing configuration file update-cloudflare-records.yaml or invalid syntax!&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="313">
            
            

            

            <code class="ruby">      exit 0</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="314">
            
            

            

            <code class="ruby">    else</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="315">
            
            

            

            <code class="ruby">      config_file=${parent_path}/update-cloudflare-records.yaml</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="316">
            
            

            

            <code class="ruby">    fi</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="317">
            
            

            

            <code class="ruby">  else</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="318">
            <span class="hits">1</span>
            

            

            <code class="ruby">    if [ ! -f &quot;${parent_path}&quot;/&quot;$1&quot; ]; then</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="319">
            
            

            

            <code class="ruby">      error_msg &quot;Error! Missing configuration file &#39;$1&#39; or invalid syntax!&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="320">
            
            

            

            <code class="ruby">      exit 0</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="321">
            
            

            

            <code class="ruby">    else</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="322">
            <span class="hits">1</span>
            

            

            <code class="ruby">      config_file=${parent_path}/&quot;$1&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="323">
            
            

            

            <code class="ruby">    fi</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="324">
            
            

            

            <code class="ruby">  fi</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="325">
            <span class="hits">1</span>
            

            

            <code class="ruby">  echo &quot;$config_file&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="326">
            
            

            

            <code class="ruby">}</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="327">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="328">
            
            

            

            <code class="ruby">##################################################################</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="329">
            
            

            

            <code class="ruby"># YAML PARSER (from: https://github.com/jasperes/bash-yaml)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="330">
            
            

            

            <code class="ruby"># shellcheck disable=SC1003</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="331">
            
            

            

            <code class="ruby">parse_yaml() {</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="5" data-linenumber="332">
            <span class="hits">5</span>
            

            

            <code class="ruby">  local yaml_file=$1</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="5" data-linenumber="333">
            <span class="hits">5</span>
            

            

            <code class="ruby">  local prefix=$2</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="5" data-linenumber="334">
            <span class="hits">5</span>
            

            

            <code class="ruby">  local s</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="5" data-linenumber="335">
            <span class="hits">5</span>
            

            

            <code class="ruby">  local w</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="5" data-linenumber="336">
            <span class="hits">5</span>
            

            

            <code class="ruby">  local fs</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="337">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="5" data-linenumber="338">
            <span class="hits">5</span>
            

            

            <code class="ruby">  s=&#39;[[:space:]]*&#39;</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="5" data-linenumber="339">
            <span class="hits">5</span>
            

            

            <code class="ruby">  w=&#39;[a-zA-Z0-9_.-]*&#39;</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="15" data-linenumber="340">
            <span class="hits">15</span>
            

            

            <code class="ruby">  fs=&quot;$(echo @ | tr @ &#39;\034&#39;)&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="341">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="342">
            
            

            

            <code class="ruby">  (</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="343">
            <span class="hits">1</span>
            

            

            <code class="ruby">    sed -e &#39;/- [^\“]&#39;&quot;[^\&#39;]&quot;&#39;.*: /s|\([ ]*\)- \([[:space:]]*\)|\1-\&#39;$&#39;\n&#39;&#39;  \1\2|g&#39; |</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="344">
            <span class="hits">1</span>
            

            

            <code class="ruby">      sed -ne &#39;/^--/s|--||g; s|\&quot;|\\\&quot;|g; s/[[:space:]]*$//g;&#39; \</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="345">
            
            

            

            <code class="ruby">        -e &#39;s/\$/\\\$/g&#39; \</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="346">
            
            

            

            <code class="ruby">        -e &quot;/#.*[\&quot;\&#39;]/!s| #.*||g; /^#/s|#.*||g;&quot; \</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="347">
            
            

            

            <code class="ruby">        -e &quot;s|^\($s\)\($w\)$s:$s\&quot;\(.*\)\&quot;$s\$|\1$fs\2$fs\3|p&quot; \</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="348">
            
            

            

            <code class="ruby">        -e &quot;s|^\($s\)\($w\)${s}[:-]$s\(.*\)$s\$|\1$fs\2$fs\3|p&quot; |</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="349">
            <span class="hits">1</span>
            

            

            <code class="ruby">      awk -F&quot;$fs&quot; &#39;{</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="350">
            
            

            

            <code class="ruby">            indent = length($1)/2;</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="351">
            
            

            

            <code class="ruby">            if (length($2) == 0) { conj[indent]=&quot;+&quot;;} else {conj[indent]=&quot;&quot;;}</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="352">
            
            

            

            <code class="ruby">            vname[indent] = $2;</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="353">
            
            

            

            <code class="ruby">            for (i in vname) {if (i &gt; indent) {delete vname[i]}}</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="354">
            
            

            

            <code class="ruby">                if (length($3) &gt; 0) {</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="355">
            
            

            

            <code class="ruby">                    vn=&quot;&quot;; for (i=0; i&lt;indent; i++) {vn=(vn)(vname[i])(&quot;_&quot;)}</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="356">
            
            

            

            <code class="ruby">                    printf(&quot;%s%s%s%s=(\&quot;%s\&quot;)\n&quot;, &quot;&#39;&quot;$prefix&quot;&#39;&quot;,vn, $2, conj[indent-1], $3);</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="357">
            
            

            

            <code class="ruby">                }</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="358">
            
            

            

            <code class="ruby">            }&#39; |</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="359">
            <span class="hits">1</span>
            

            

            <code class="ruby">      sed -e &#39;s/_=/+=/g&#39; |</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="360">
            <span class="hits">1</span>
            

            

            <code class="ruby">      awk &#39;BEGIN {</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="361">
            <span class="hits">1</span>
            

            

            <code class="ruby">                FS=&quot;=&quot;;</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="362">
            <span class="hits">1</span>
            

            

            <code class="ruby">                OFS=&quot;=&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="363">
            <span class="hits">1</span>
            

            

            <code class="ruby">            }</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="364">
            <span class="hits">1</span>
            

            

            <code class="ruby">            /(-|\.).*=/ {</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="365">
            <span class="hits">1</span>
            

            

            <code class="ruby">                gsub(&quot;-|\\.&quot;, &quot;_&quot;, $1)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="366">
            <span class="hits">1</span>
            

            

            <code class="ruby">            }</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="367">
            <span class="hits">1</span>
            

            

            <code class="ruby">            { print }&#39;</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="368">
            
            

            

            <code class="ruby">  ) &lt;&quot;$yaml_file&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="369">
            
            

            

            <code class="ruby">}</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="370">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="371">
            
            

            

            <code class="ruby">unset_variables() {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="372">
            
            

            

            <code class="ruby">  # Pulls out the variable names and unsets them.</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="5" data-linenumber="373">
            <span class="hits">5</span>
            

            

            <code class="ruby">  local variable_string=&quot;($*)&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="5" data-linenumber="374">
            <span class="hits">5</span>
            

            

            <code class="ruby">  unset variables</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="5" data-linenumber="375">
            <span class="hits">5</span>
            

            

            <code class="ruby">  variables=()</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="5" data-linenumber="376">
            <span class="hits">5</span>
            

            

            <code class="ruby">  for variable in &quot;${variable_string[@]}&quot;; do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="25" data-linenumber="377">
            <span class="hits">25</span>
            

            

            <code class="ruby">    tmpvar=$(echo &quot;$variable&quot; | grep &#39;=&#39; | sed &#39;s/=.*//&#39; | sed &#39;s/+.*//&#39;)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="5" data-linenumber="378">
            <span class="hits">5</span>
            

            

            <code class="ruby">    variables+=(&quot;$tmpvar&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="379">
            
            

            

            <code class="ruby">  done</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="5" data-linenumber="380">
            <span class="hits">5</span>
            

            

            <code class="ruby">  for variable in &quot;${variables[@]}&quot;; do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="5" data-linenumber="381">
            <span class="hits">5</span>
            

            

            <code class="ruby">    if [ -n &quot;$variable&quot; ]; then</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="382">
            <span class="hits">1</span>
            

            

            <code class="ruby">      unset &quot;$variable&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="383">
            
            

            

            <code class="ruby">    fi</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="384">
            
            

            

            <code class="ruby">  done</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="385">
            
            

            

            <code class="ruby">}</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="386">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="387">
            
            

            

            <code class="ruby">create_variables() {</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="5" data-linenumber="388">
            <span class="hits">5</span>
            

            

            <code class="ruby">  local yaml_file=&quot;$1&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="5" data-linenumber="389">
            <span class="hits">5</span>
            

            

            <code class="ruby">  local prefix=&quot;&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="5" data-linenumber="390">
            <span class="hits">5</span>
            

            

            <code class="ruby">  local yaml_string</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="10" data-linenumber="391">
            <span class="hits">10</span>
            

            

            <code class="ruby">  yaml_string=&quot;$(parse_yaml &quot;$yaml_file&quot; &quot;$prefix&quot;)&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="5" data-linenumber="392">
            <span class="hits">5</span>
            

            

            <code class="ruby">  unset_variables &quot;${yaml_string}&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="6" data-linenumber="393">
            <span class="hits">6</span>
            

            

            <code class="ruby">  eval &quot;${yaml_string}&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="394">
            <span class="hits">1</span>
            

            

            <code class="ruby">}</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="395">
            <span class="hits">1</span>
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="396">
            <span class="hits">1</span>
            

            

            <code class="ruby">##################################################################</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="397">
            <span class="hits">1</span>
            

            

            <code class="ruby"># SCRIPT</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="398">
            <span class="hits">1</span>
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="399">
            <span class="hits">1</span>
            

            

            <code class="ruby">###  Create update-cloudflare-records.log file of the last run for debug</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="11" data-linenumber="400">
            <span class="hits">11</span>
            

            

            <code class="ruby">parent_path=&quot;$(dirname &quot;${BASH_SOURCE[0]}&quot;)&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="6" data-linenumber="401">
            <span class="hits">6</span>
            

            

            <code class="ruby">FILE=${parent_path}/update-cloudflare-records.log</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="6" data-linenumber="402">
            <span class="hits">6</span>
            

            

            <code class="ruby">if ! [ -x &quot;$FILE&quot; ]; then</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="6" data-linenumber="403">
            <span class="hits">6</span>
            

            

            <code class="ruby">  touch &quot;$FILE&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="404">
            <span class="hits">1</span>
            

            

            <code class="ruby">fi</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="405">
            <span class="hits">1</span>
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="6" data-linenumber="406">
            <span class="hits">6</span>
            

            

            <code class="ruby">LOG_FILE=${parent_path}&#39;/update-cloudflare-records.log&#39;</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="407">
            <span class="hits">1</span>
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="408">
            <span class="hits">1</span>
            

            

            <code class="ruby">### Write last run of STDOUT &amp; STDERR as log file and prints to screen</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="11" data-linenumber="409">
            <span class="hits">11</span>
            

            

            <code class="ruby">exec &gt; &gt;(tee &quot;$LOG_FILE&quot;) 2&gt;&amp;1</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="6" data-linenumber="410">
            <span class="hits">6</span>
            

            

            <code class="ruby">printf &quot;\n&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="11" data-linenumber="411">
            <span class="hits">11</span>
            

            

            <code class="ruby">echo &quot;DATE: $(date &quot;+%Y-%m-%d %H:%M:%S&quot;)&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="6" data-linenumber="412">
            <span class="hits">6</span>
            

            

            <code class="ruby">printf &quot;\n&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="413">
            <span class="hits">1</span>
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="414">
            <span class="hits">1</span>
            

            

            <code class="ruby">#################################</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="415">
            <span class="hits">1</span>
            

            

            <code class="ruby"># Locate .yaml config file or set custom config file</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="7" data-linenumber="416">
            <span class="hits">7</span>
            

            

            <code class="ruby">read -r config_file &lt;&lt;&lt; &quot;$(settings_file_validation &quot;$1&quot;)&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="417">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="418">
            
            

            

            <code class="ruby">#################################</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="419">
            
            

            

            <code class="ruby"># Create variables from .yaml config file</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="5" data-linenumber="420">
            <span class="hits">5</span>
            

            

            <code class="ruby">create_variables &quot;$config_file&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="421">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="422">
            
            

            

            <code class="ruby">#################################</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="423">
            
            

            

            <code class="ruby"># VALIDATE CONFIG FILE SETTINGS (.yaml)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="5" data-linenumber="424">
            <span class="hits">5</span>
            

            

            <code class="ruby">settings_validation</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="425">
            <span class="hits">1</span>
            

            

            <code class="ruby">settings_domains_validation</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="426">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="427">
            
            

            

            <code class="ruby">#################################</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="428">
            
            

            

            <code class="ruby"># Cloudflare API</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="429">
            <span class="hits">2</span>
            

            

            <code class="ruby">read -r api_zone_id api_zone_token &lt;&lt;&lt; &quot;$(get_api_settings)&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="430">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="431">
            
            

            

            <code class="ruby">#################################</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="432">
            
            

            

            <code class="ruby"># Iterate over domains array</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="433">
            <span class="hits">1</span>
            

            

            <code class="ruby">n_doms=${#domains__name[@]}</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="8" data-linenumber="434">
            <span class="hits">8</span>
            

            

            <code class="ruby">for ((i = 0; i &lt; n_doms; i++)); do</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="435">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="436">
            
            

            

            <code class="ruby">  ### Get ith-domain settings</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="6" data-linenumber="437">
            <span class="hits">6</span>
            

            

            <code class="ruby">  read -r domain_name domain_ip_type enable_ipv4 enable_ipv6 domain_proxied domain_ttl &lt;&lt;&lt; &quot;$(get_domain_settings &quot;$i&quot;)&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="6" data-linenumber="438">
            <span class="hits">6</span>
            

            

            <code class="ruby">  [[ &quot;${domain_ttl}&quot; == &quot;auto&quot; ]] &amp;&amp; ttl=1 || ttl=${domain_ttl}</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="439">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="440">
            
            

            

            <code class="ruby">  ### Get Host IP (external or internal) [VARS: ip4 and ip6]</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="3" data-linenumber="441">
            <span class="hits">3</span>
            

            

            <code class="ruby">  get_ip &quot;$domain_ip_type&quot; &quot;$enable_ipv4&quot; &quot;$enable_ipv6&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="442">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="443">
            
            

            

            <code class="ruby">  ### Get IP Domain from Cloudflare API</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="3" data-linenumber="444">
            <span class="hits">3</span>
            

            

            <code class="ruby">  get_dns_record_ip &quot;$domain_name&quot; &quot;$api_zone_id&quot; &quot;$api_zone_token&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="6" data-linenumber="445">
            <span class="hits">6</span>
            

            

            <code class="ruby">  [ $error_dom == true ] &amp;&amp; continue</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="446">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="447">
            
            

            

            <code class="ruby">  ### Check if IPv4 or proxy have changed and update if needed</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="448">
            
            

            

            <code class="ruby">  if [ &quot;$enable_ipv4&quot; == true ] &amp;&amp; [ &quot;${dns_record_ip4}&quot; == &quot;${ip4}&quot; ] &amp;&amp; [ &quot;${is_proxied4}&quot; == &quot;${domain_proxied}&quot; ]; then</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="449">
            
            

            

            <code class="ruby">    up_to_date &quot;IPv4&quot; &quot;$domain_name&quot; &quot;$dns_record_ip4&quot; &quot;$is_proxied4&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="450">
            
            

            

            <code class="ruby">  else</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="451">
            
            

            

            <code class="ruby">    ### Push new dns record information to cloudflare&#39;s api</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="452">
            
            

            

            <code class="ruby">    load_msg &quot;New DNS record IPv4 of ${domain_name} is: ${dns_record_ip4}. Trying to update...&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="453">
            
            

            

            <code class="ruby">    update_dns_record_4=$(write_record &quot;$api_zone_id&quot; &quot;$dns_record_id_4&quot; &quot;$api_zone_token&quot; &quot;A&quot; &quot;$domain_name&quot; &quot;$ip4&quot; &quot;$ttl&quot; &quot;$domain_proxied&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="454">
            
            

            

            <code class="ruby">    push_validation &quot;$update_dns_record_4&quot; &quot;IPv4&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="455">
            
            

            

            <code class="ruby">  fi</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="456">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="457">
            
            

            

            <code class="ruby">  ### Check if IPv6 or proxy have changed and update if needed</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="458">
            
            

            

            <code class="ruby">  if [ &quot;$enable_ipv6&quot; == true ] &amp;&amp; [ &quot;${dns_record_ip6}&quot; == &quot;${ip6}&quot; ] &amp;&amp; [ &quot;${is_proxied6}&quot; == &quot;${domain_proxied}&quot; ]; then</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="459">
            
            

            

            <code class="ruby">    up_to_date &quot;IPv6&quot; &quot;$domain_name&quot; &quot;$dns_record_ip6&quot; &quot;$is_proxied6&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="460">
            
            

            

            <code class="ruby">  else</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="461">
            
            

            

            <code class="ruby">    ### Push new dns record information to cloudflare&#39;s api</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="462">
            
            

            

            <code class="ruby">    load_msg &quot;New DNS record IPv6 of ${domain_name} is: ${dns_record_ip6}. Trying to update...&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="463">
            
            

            

            <code class="ruby">    update_dns_record_6=$(write_record &quot;$api_zone_id&quot; &quot;$dns_record_id_6&quot; &quot;$api_zone_token&quot; &quot;AAAA&quot; &quot;$domain_name&quot; &quot;$ip6&quot; &quot;$ttl&quot; &quot;$domain_proxied&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="464">
            
            

            

            <code class="ruby">    push_validation &quot;$update_dns_record_6&quot; &quot;IPv6&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="465">
            
            

            

            <code class="ruby">  fi</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="466">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="467">
            
            

            

            <code class="ruby">  # Show results</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="468">
            
            

            

            <code class="ruby">  if [ &quot;$domain_ttl&quot; == &quot;auto&quot; ]; then</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="469">
            
            

            

            <code class="ruby">    ttl_info=&quot;Automatic&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="470">
            
            

            

            <code class="ruby">  else</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="471">
            
            

            

            <code class="ruby">    ttl_info=&quot;$ttl secods&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="472">
            
            

            

            <code class="ruby">  fi</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="473">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="474">
            
            

            

            <code class="ruby">  printf &quot;\n&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="475">
            
            

            

            <code class="ruby">  green_msg &quot;----------------------------------------&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="476">
            
            

            

            <code class="ruby">  done_fb_msg &quot;DOMAIN: $domain_name&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="477">
            
            

            

            <code class="ruby">  green_msg &quot;----------------------------------------&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="478">
            
            

            

            <code class="ruby">  [[ &quot;$enable_ipv4&quot; == true ]] &amp;&amp; green_msg &quot;Current IPv4 Address: $ip4&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="479">
            
            

            

            <code class="ruby">  [[ &quot;$enable_ipv6&quot; == true ]] &amp;&amp; green_msg &quot;Current IPv6 Address: $ip6&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="480">
            
            

            

            <code class="ruby">  green_msg &quot;Cloudflare proxy    : $domain_proxied&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="481">
            
            

            

            <code class="ruby">  green_msg &quot;TTL                 : $ttl_info&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="482">
            
            

            

            <code class="ruby">  green_msg &quot;----------------------------------------&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="483">
            
            

            

            <code class="ruby">  printf &quot;\n&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="484">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="485">
            
            

            

            <code class="ruby">  ### Telegram notification</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="486">
            
            

            

            <code class="ruby">  # shellcheck disable=SC2154</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="487">
            
            

            

            <code class="ruby">  if [ &quot;${notifications_telegram_enabled}&quot; == true ]; then</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="488">
            
            

            

            <code class="ruby">    telegram_notification=$(</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="489">
            
            

            

            <code class="ruby">      curl -s -X GET &quot;https://api.telegram.org/bot${notifications_telegram_bot_token}/sendMessage?chat_id=${notifications_telegram_chat_id}&quot; --data-urlencode &quot;text=${domain_name} DNS record updated to: ${ip4} / ${ip6}&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="490">
            
            

            

            <code class="ruby">    )</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="491">
            
            

            

            <code class="ruby">    if [[ ${telegram_notification} == *&quot;\&quot;ok\&quot;:false&quot;* ]]; then</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="492">
            
            

            

            <code class="ruby">      echo &quot;${telegram_notification}&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="493">
            
            

            

            <code class="ruby">      echo &quot;Error! Telegram notification failed&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="494">
            
            

            

            <code class="ruby">    fi</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="495">
            
            

            

            <code class="ruby">  fi</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="496">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="497">
            
            

            

            <code class="ruby">done</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
      </div>
    </div>
  </body>
</html>
